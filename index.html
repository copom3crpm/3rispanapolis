<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3ª RISP Anápolis – AISP 14 e 15 (2025)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css"/>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;}
        body{font-family:Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);color:#333;min-height:100vh;}
        .container{max-width:1350px;margin:20px auto;background:#fff;border-radius:20px;box-shadow:0 20px 80px rgba(0,0,0,0.5);overflow:hidden;}
        .header{background:linear-gradient(135deg,#0a3d62,#1e5a8e);color:#fff;padding:50px 20px;text-align:center;}
        .header h1{font-size:34px;font-weight:900;letter-spacing:2px;}
        .header p{font-size:19px;margin-top:10px;}
        .institutional{background:#f8f9fa;border-left:6px solid #caa347;padding:30px;margin:30px;border-radius:12px;font-size:14px;line-height:1.9;color:#2c3e50;}
        .stats{display:flex;justify-content:center;flex-wrap:wrap;gap:30px;padding:40px 20px;background:#f8f9fa;}
        .stat{background:#fff;padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,0.1);min-width:200px;text-align:center;}
        .stat-number{font-size:48px;font-weight:900;color:#0a3d62;}
        .search{padding:60px 40px;text-align:center;background:#fff;}
        #bairroInput{width:100%;max-width:850px;padding:20px 28px;font-size:19px;border:3px solid #e0e0e0;border-radius:15px;}
        #bairroInput:focus{outline:none;border-color:#0a3d62;box-shadow:0 0 25px rgba(10,61,98,0.3);}
        #buscarBtn,#geoBtn{margin-top:18px;padding:18px 60px;font-size:19px;border:none;border-radius:15px;cursor:pointer;font-weight:bold;}
        #buscarBtn{background:#0a3d62;color:#fff;}
        #geoBtn{background:#caa347;color:#fff;margin-left:15px;}
        #sugestoes{position:absolute;background:#fff;border:1px solid #ddd;border-radius:12px;max-height:350px;overflow-y:auto;width:850px;box-shadow:0 15px 50px rgba(0,0,0,0.25);z-index:1000;display:none;left:50%;transform:translateX(-50%);margin-top:5px;}
        .sugestao-item{padding:16px 25px;cursor:pointer;border-bottom:1px solid #eee;text-align:left;}
        .sugestao-item:hover{background:#0a3d62;color:#fff;}
        .result{padding:50px;background:#f9fbfc;display:none;}
        .result.show{display:block;animation:fadeIn .7s;}
        @keyframes fadeIn{from{opacity:0;transform:translateY(40px)}to{opacity:1;transform:none}}
        .info{background:linear-gradient(135deg,#e8f4f8,#f0f8ff);border-left:6px solid #caa347;padding:35px;border-radius:15px;margin-bottom:30px;}
        .badge{background:linear-gradient(135deg,#caa347,#d4af37);color:#fff;padding:12px 30px;border-radius:30px;font-weight:bold;font-size:20px;display:inline-block;}
        #map{height:550px;border-radius:15px;border:4px solid #0a3d62;margin-top:25px;}
        .footer{text-align:center;padding:40px;background:#0a3d62;color:#fff;font-size:15px;}
        
        @media(max-width: 768px){
            .header h1{font-size: 24px;}
            .stat{min-width: 100%;}
            #buscarBtn, #geoBtn{width: 100%; margin-left: 0; margin-top: 10px;}
            #sugestoes{width: 90%;}
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>3ª RISP – CONSULTA OFICIAL DE BAIRROS</h1>
        <p>AISP 14 (Norte) e AISP 15 (Sul) – Anápolis/GO – 2025</p>
    </div>
    <div class="institutional">
        <strong>ESTADO DE GOIÁS • SECRETARIA DA SEGURANÇA PÚBLICA • POLÍCIA MILITAR</strong><br>
        <strong>3ª RISP • Minuta SEI 202500016009205 • Documento Oficial</strong>
    </div>
    <div class="stats">
        <div class="stat"><div class="stat-number">334</div><div>Bairros Catalogados</div></div>
        <div class="stat"><div class="stat-number">2</div><div>AISPs</div></div>
        <div class="stat"><div class="stat-number">1</div><div>Município</div></div>
    </div>
    <div class="search">
        <label style="font-size:25px;color:#0a3d62;font-weight:700;display:block;margin-bottom:30px;">
            Digite o bairro de Anápolis
        </label>
        <div style="position:relative;display:block;">
            <input type="text" id="bairroInput" placeholder="Ex: Jundiaí, Vila Jaiara, Calixtolândia, IAPC..." autocomplete="off">
            <div id="sugestoes"></div>
        </div>
        <button id="buscarBtn">Consultar Bairro</button>
        <button id="geoBtn">Minha Localização</button>
    </div>

    <div id="result" class="result">
        <div id="info" class="info"></div>
        <div style="text-align:center;margin:30px 0;">
            <button onclick="window.print()" style="padding:14px 40px;background:#0a3d62;color:#fff;border:none;border-radius:12px;font-size:17px;cursor:pointer;">
                Imprimir / Salvar PDF
            </button>
        </div>
        <div id="map"></div>
    </div>

    <div class="footer">
        <strong>3ª RISP Anápolis • Base de Dados Completa (Minuta 2025) • Offline</strong>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
<script>
// CONFIGURAÇÃO DOS DADOS DAS AISPS
const aisp14 = "AISP 14 - Norte|28º BPM|1º DP, 4º DP e 5º DP";
const aisp15 = "AISP 15 - Sul|4º BPM|2º DP, 3º DP e 6º DP";

// BASE DE DADOS COMPLETA - 334 BAIRROS (EXTRAÍDO DO PDF OFICIAL)
const bairros = {
    // --- AISP 14 (NORTE) ---
    "Adriana Parque": aisp14,
    "Anexo Antônio Fernandes": aisp14,
    "Anexo Bom Sucesso": aisp14,
    "Anexo Frei Eustáquio": aisp14,
    "Anexo Itamaraty": aisp14,
    "Anexo Maracananzinho": aisp14,
    "Antônio Fernandes": aisp14,
    "Alvorada": aisp14,
    "Bandeiras": aisp14,
    "Boa Vista": aisp14,
    "Bom Sucesso": aisp14,
    "Chácaras Boa Vista I Etapa": aisp14,
    "Chácaras Boa Vista II Etapa": aisp14,
    "Chácaras Colorado": aisp14,
    "Chácaras De Lazer São Jorge": aisp14,
    "Chácaras De Recreio Mansões Do Planalto": aisp14,
    "Chácaras Miranópolis": aisp14,
    "Chácaras Recreio Anicuns": aisp14,
    "Chácaras Vale Das Antas": aisp14,
    "Cidade Jardim": aisp14,
    "Cidade Universitária": aisp14,
    "Condomínio Residencial Belas Artes": aisp14,
    "Condomínio Residencial Grand Trianon": aisp14,
    "Condomínio Residencial Villa Lobos": aisp14,
    "Conjunto IAPC": aisp14,
    "Conjunto Residencial Jamaica (IAPC)": aisp14,
    "Distrito De Goialândia": aisp14,
    "Distrito De Interlândia": aisp14,
    "Distrito De Souzânia": aisp14,
    "Dom Pedro II": aisp14,
    "Estância Itamaraty": aisp14,
    "Estância Vale Verde": aisp14,
    "Estância Vila Rica": aisp14,
    "Frei Eustáquio": aisp14,
    "Industrial Da Estação": aisp14,
    "Itamaraty": aisp14,
    "Itamaraty II Etapa": aisp14,
    "Itamaraty III Etapa": aisp14,
    "Itamaraty IV Etapa": aisp14,
    "Jardim Alexandrina": aisp14,
    "Jardim Bandeirante": aisp14,
    "Jardim Das Américas 1ª Etapa": aisp14,
    "Jardim Das Américas 2ª Etapa": aisp14,
    "Jardim Das Américas 3ª Etapa": aisp14,
    "Jardim Das Oliveiras": aisp14,
    "Jardim Dos Ipês": aisp14,
    "Jardim Goiano": aisp14,
    "Jardim Nações Unidas": aisp14,
    "Jardim Nova Alexandrina": aisp14,
    "Jardim Panorama": aisp14,
    "Jardim Petrópolis": aisp14,
    "Jardim Progresso": aisp14,
    "Jardim Promissão": aisp14,
    "Jardim Santana": aisp14,
    "Jardim Santana 2ª Etapa": aisp14,
    "Jardim São Jorge": aisp14,
    "Jardim Silveira": aisp14,
    "Jardim Suíço": aisp14,
    "Lapa": aisp14,
    "Las Palmas": aisp14,
    "Loteamento Guanabara": aisp14,
    "Loteamento Residencial América": aisp14,
    "Maracanã": aisp14,
    "Maracananzinho": aisp14,
    "Nossa Senhora Aparecida": aisp14,
    "Nova Vila Jaiara": aisp14,
    "Parque Das Nações": aisp14,
    "Parque Dos Eucaliptos": aisp14,
    "Parque Dos Pirineus": aisp14,
    "Parque Iracema": aisp14,
    "Parque Michel": aisp14,
    "Parque Residencial Das Flores": aisp14,
    "Recanto Do Sol": aisp14,
    "Residencial Aldeia Dos Sonhos": aisp14,
    "Residencial Ana Caroline": aisp14,
    "Residencial Araguaia": aisp14,
    "Residencial Araujoville": aisp14,
    "Residencial Caminho Das Águas": aisp14,
    "Residencial Centenário": aisp14,
    "Residencial Das Rosas": aisp14,
    "Residencial Dom Emanuel": aisp14,
    "Residencial Dom Felipe": aisp14,
    "Residencial Flor Do Cerrado I Etapa": aisp14,
    "Residencial Flor Do Cerrado II Etapa": aisp14,
    "Residencial Mônica Braga": aisp14,
    "Residencial Monte Sinai": aisp14,
    "Residencial Palmeiras": aisp14,
    "Residencial Paris": aisp14,
    "Residencial Portal Do Cerrado": aisp14,
    "Residencial Portal Do Sol": aisp14,
    "Residencial Rio Jordão": aisp14,
    "Residencial Santa Cruz": aisp14,
    "Residencial Terezinha Braga": aisp14,
    "Residencial Vale Do Sol I Etapa": aisp14,
    "Residencial Vale Do Sol II Etapa": aisp14,
    "Residencial Vale Dos Pirineus": aisp14,
    "Residencial Valência": aisp14,
    "Residencial Veneza": aisp14,
    "Residencial Verona": aisp14,
    "Residencial Villa Bella": aisp14,
    "Residencial Virginia Corrêa": aisp14,
    "Reverendo Arquibald (Conjunto Mirage)": aisp14,
    "Santos Dumont": aisp14,
    "São Carlos I Etapa": aisp14,
    "São Carlos II Etapa": aisp14,
    "São José": aisp14,
    "São Lourenço": aisp14,
    "Setor Bougainville": aisp14,
    "Setor Central": aisp14,
    "Setor Escala": aisp14,
    "Setor Escala 2ª Etapa": aisp14,
    "Setor Lago Dos Buritis": aisp14,
    "Setor Residencial Jandaia I Etapa": aisp14,
    "Setor Residencial Jandaia II Etapa": aisp14,
    "Sítio De Recreio Jardim Boa Vista": aisp14,
    "Sítios De Recreio Americano Do Brasil": aisp14,
    "Sítios De Recreio Das Mansões": aisp14,
    "Sítios De Recreio Denise": aisp14,
    "Sítios De Recreio Jardim Peixoto": aisp14,
    "Vila Brasil": aisp14,
    "Vila Calixto Abrão": aisp14,
    "Vila Corumbá": aisp14,
    "Vila Das Acácias": aisp14,
    "Vila Dom Bosco": aisp14,
    "Vila Dos Oficiais": aisp14,
    "Vila Fabril": aisp14,
    "Vila Falluh": aisp14,
    "Vila Gonçalves": aisp14,
    "Vila Harmonia": aisp14,
    "Vila Interlândia": aisp14,
    "Vila Jacinto": aisp14,
    "Vila Jaiara": aisp14,
    "Vila Jaiara Norte": aisp14,
    "Vila Menino Jesus": aisp14,
    "Vila Moreira": aisp14,
    "Vila Norte": aisp14,
    "Vila Nova Jaiara": aisp14,
    "Vila Santa Helena": aisp14,
    "Vila Santa Isabel": aisp14,
    "Vila Santa Isabel II Etapa": aisp14,
    "Vila Santa Maria": aisp14,
    "Vila São João": aisp14,
    "Vila São Jorge": aisp14,
    "Vila Tocantins": aisp14,
    "Vila União": aisp14,
    "Village Jardim Anápolis": aisp14,
    "Zona Rural AISP 14": aisp14,

    // --- AISP 15 (SUL) ---
    "Residencial Girassol": aisp15,
    "Vila Residencial Pedro Ludovico": aisp15,
    "Setor Residencial Pedro Ludovico": aisp15,
    "Alto Da Bela Vista": aisp15,
    "Anápolis City": aisp15,
    "Andracel Center": aisp15,
    "Branápolis": aisp15,
    "Campus Da UEG": aisp15,
    "Chácara Jonas Duarte": aisp15,
    "Condomínio Vale dos Pássaros": aisp15,
    "Condomínio Alphaville Anápolis": aisp15,
    "Condomínio Residencial Gaudí": aisp15,
    "Condomínio Sunflower": aisp15,
    "Condomínio Terras Alphaville Anápolis": aisp15,
    "Conjunto Habitacional Esperança II": aisp15,
    "Conjunto Habitacional Vila União": aisp15,
    "Conjunto Raul Balduino": aisp15,
    "Conjunto Residencial Vila Verde": aisp15,
    "Daia Distrito Agroindustrial De Anápolis": aisp15,
    "Eldorado": aisp15,
    "Gran Ville 2ª Etapa": aisp15,
    "Ipiranga Atlético Clube": aisp15,
    "Jardim América": aisp15,
    "Jardim Ana Cláudia": aisp15,
    "Jardim Ana Paula": aisp15,
    "Jardim Arco Verde 1ª Etapa": aisp15,
    "Jardim Arco Verde 2ª Etapa": aisp15,
    "Jardim Bom Clima": aisp15,
    "Jardim Calixto": aisp15,
    "Jardim Das Samambaias": aisp15,
    "Jardim Dianna": aisp15,
    "Jardim Eldorado": aisp15,
    "Jardim Europa": aisp15,
    "Jardim Gonçalves": aisp15,
    "Jardim Itália": aisp15,
    "Jardim Primavera 3ª Etapa": aisp15,
    "Jardim Santa Cecília": aisp15,
    "Jardim São Paulo": aisp15,
    "Jibran El Hadj": aisp15,
    "Jk Nova Capital": aisp15,
    "Jk Setor Oeste": aisp15,
    "Jóquei Club": aisp15,
    "Jundiaí": aisp15,
    "Jundiaí Industrial": aisp15,
    "Loteamento Novo Jundiaí": aisp15,
    "Loteamento Olhos D'Água": aisp15,
    "Loteamento Reny Cury": aisp15,
    "Loteamento Residencial Victor Braga": aisp15,
    "Novo Paraíso": aisp15,
    "Parque Brasília 1ª Etapa": aisp15,
    "Parque Brasília 2ª Etapa": aisp15,
    "Parque Calixtópolis I": aisp15,
    "Parque Calixtópolis II": aisp15,
    "Parque Das Primaveras": aisp15,
    "Parque São João": aisp15,
    "Plataforma Logística Multimodal": aisp15,
    "Polocentro 1ª Etapa": aisp15,
    "Polocentro 2ª Etapa": aisp15,
    "Privé Lírios Do Campo": aisp15,
    "Residencial Adelaide": aisp15,
    "Residencial Alphaville": aisp15,
    "Residencial Arco Íris": aisp15,
    "Residencial Bela Vista": aisp15,
    "Residencial Boa Esperança": aisp15,
    "Residencial Cerejeiras": aisp15,
    "Residencial Copacabana": aisp15,
    "Residencial Do Cerrado": aisp15,
    "Residencial Geovanni Braga": aisp15,
    "Residencial Ildefonso Limírio": aisp15,
    "Residencial Itatiaia": aisp15,
    "Residencial Itororó": aisp15,
    "Residencial Jardins Do Lago": aisp15,
    "Residencial Leblon": aisp15,
    "Residencial Marla Cristina": aisp15,
    "Residencial Morumbi": aisp15,
    "Residencial Novo Mundo": aisp15,
    "Residencial Porto Rico": aisp15,
    "Residencial Santo Antônio": aisp15,
    "Residencial Santo Expedito": aisp15,
    "Residencial São Cristóvão": aisp15,
    "Residencial São Marcos": aisp15,
    "Residencial Shangrilá": aisp15,
    "Residencial Tangará": aisp15,
    "Santa Clara": aisp15,
    "Santo André": aisp15,
    "Santo Antônio": aisp15,
    "São João": aisp15,
    "São Sebastião": aisp15,
    "Setor Sul I Etapa": aisp15,
    "Setor Sul II Etapa": aisp15,
    "Setor Sul III Etapa": aisp15,
    "Setor Sul Jamil Miguel 1ª Etapa": aisp15,
    "Setor Sul Jamil Miguel 2ª Etapa": aisp15,
    "Setor Summerville": aisp15,
    "Sítios De Recreio Presidente": aisp15,
    "Sítios De Recreio Vale Das Laranjeiras": aisp15,
    "Vila Celina": aisp15,
    "Vila Dona Maria": aisp15,
    "Vila Dos Sargentos": aisp15,
    "Vila Esperança": aisp15,
    "Vila Formosa": aisp15,
    "Vila Formosa I Etapa": aisp15,
    "Vila Formosa II Etapa": aisp15,
    "Vila Formosa III Etapa": aisp15,
    "Vila Formosa IV Etapa": aisp15,
    "Vila Formosa VI Etapa": aisp15,
    "Vila Goiás": aisp15,
    "Vila Góis": aisp15,
    "Vila Guarani": aisp15,
    "Vila Industrial": aisp15,
    "Vila João Luiz De Oliveira": aisp15,
    "Vila Jussara": aisp15,
    "Vila Mariana": aisp15,
    "Vila Mathias": aisp15,
    "Vila Miguel Jorge": aisp15,
    "Vila Milmar": aisp15,
    "Vila Nossa Senhora D Abadia": aisp15,
    "Vila Popular Munir Calixto": aisp15,
    "Vila Santa Maria De Nazareth": aisp15,
    "Vila Santa Rita": aisp15,
    "Vila Santa Rosa": aisp15,
    "Vila Santana": aisp15,
    "Vila São Joaquim": aisp15,
    "Vila São Joaquim II Etapa": aisp15,
    "Vila São José": aisp15,
    "Vivian Parque I Etapa": aisp15,
    "Vivian Parque II Etapa": aisp15,
    "Batista": aisp15,
    "Calixtolândia I Etapa": aisp15,
    "Calixtolândia II Etapa": aisp15,
    "Campos Elísios": aisp15,
    "Chácaras Americanas": aisp15,
    "Condomínio Residencial Sol Nascente": aisp15,
    "Conjunto Habitacional Filostro Machado": aisp15,
    "De Lourdes": aisp15,
    "Gran Ville": aisp15,
    "Granja Santo Antônio": aisp15,
    "Jardim Alvorada": aisp15,
    "Jardim Bela Vista": aisp15,
    "Jardim Esperança": aisp15,
    "Jardim Flor De Liz": aisp15,
    "Jardim Ibirapuera": aisp15,
    "Jardim Lusitano": aisp15,
    "Jardim Palmares": aisp15,
    "Jardim Planalto": aisp15,
    "Jardim Primavera 1ª Etapa": aisp15,
    "Jardim Primavera 2ª Etapa": aisp15,
    "Jardim Tesouro": aisp15,
    "Jardim Vera Cruz": aisp15,
    "Manoel Domingues": aisp15,
    "Morada Nova": aisp15,
    "Paraíso": aisp15,
    "Parque Residencial Ander I Etapa": aisp15,
    "Parque Residencial Ander II Etapa": aisp15,
    "Parque São Conrado": aisp15,
    "Parque São Jerônimo": aisp15,
    "Residencial Airton Senna": aisp15,
    "Residencial Alfredo Abraão": aisp15,
    "Residencial Anaville": aisp15,
    "Residencial Buritis": aisp15,
    "Residencial Cidade Industrial": aisp15,
    "Residencial Daiana I": aisp15,
    "Residencial Daiana II": aisp15,
    "Residencial Do Trabalhador": aisp15,
    "Residencial Flamboyant": aisp15,
    "Residencial Florença": aisp15,
    "Residencial Gabriela": aisp15,
    "Residencial Ipanema": aisp15,
    "Residencial Nova Aliança": aisp15,
    "Residencial Roses Garden": aisp15,
    "Residencial São Vicente": aisp15,
    "Residencial Vila Feliz": aisp15,
    "Setor Industrial Aeroporto": aisp15,
    "Setor Industrial Munir Calixto": aisp15,
    "Setor Tropical": aisp15,
    "Vale Das Brisas": aisp15,
    "Vila De Lourdes": aisp15,
    "Vila João XXIII": aisp15,
    "Vila Nossa Senhora Dos Anjos": aisp15,
    "Distrito de Joanápolis": aisp15,
    "Vila Operária": aisp15,
    "Vila Rica": aisp15,
    "Vila Santa Terezinha": aisp15,
    "Vila São Vicente": aisp15,
    "Vila Sul": aisp15,
    "Residencial Campos do Jordão": aisp15,
    "Zona Rural AISP 15": aisp15
};

const listaBairros = Object.keys(bairros).sort();

// COORDENADAS APROXIMADAS PARA PONTOS CHAVE
const coordenadas = {
    "Setor Central": [-16.3285, -48.9534],
    "Vila Jaiara": [-16.3092, -48.9518],
    "Vila De Lourdes": [-16.3520, -48.9620],
    "Jundiaí": [-16.3408, -48.9556],
    "Daia Distrito Agroindustrial De Anápolis": [-16.3750, -48.9250],
    "Condomínio Alphaville Anápolis": [-16.3820, -48.9380],
    "Residencial Flamboyant": [-16.3620, -48.9250],
    "Calixtolândia I Etapa": [-16.3550, -48.9700],
    "Recanto Do Sol": [-16.2900, -48.9450],
    "Vila São Joaquim": [-16.3700, -48.9600],
    "Parque Dos Pirineus": [-16.2950, -48.9350],
    "Jardim Alexandrina": [-16.3150, -48.9550],
    "Maracananzinho": [-16.3200, -48.9650],
    "Vila Santa Maria De Nazareth": [-16.3450, -48.9500],
    "Filostro Machado": [-16.3900, -48.9500] // Aprox
};

let mapa = null;
const input = document.getElementById('bairroInput');
const sugestoes = document.getElementById('sugestoes');
const resultado = document.getElementById('result');
const info = document.getElementById('info');

input.addEventListener('input', () => {
    const termo = input.value.trim().toLowerCase();
    sugestoes.innerHTML = '';
    if (termo === '') { sugestoes.style.display = 'none'; return; }

    const encontrados = listaBairros.filter(b => b.toLowerCase().includes(termo)).slice(0, 15);
    if (encontrados.length === 0) {
        sugestoes.innerHTML = '<div class="sugestao-item">Nenhum bairro encontrado</div>';
    } else {
        encontrados.forEach(b => {
            const div = document.createElement('div');
            div.className = 'sugestao-item';
            div.innerHTML = `<strong>${b}</strong> <small style='color:#666'>(${bairros[b].split('|')[0]})</small>`;
            div.onclick = () => { input.value = b; sugestoes.style.display = 'none'; buscar(b); };
            sugestoes.appendChild(div);
        });
    }
    sugestoes.style.display = 'block';
});

document.addEventListener('click', (e) => {
    if (!input.contains(e.target) && !sugestoes.contains(e.target)) {
        sugestoes.style.display = 'none';
    }
});

document.getElementById('buscarBtn').addEventListener('click', () => {
    const termo = input.value.trim();
    const exato = listaBairros.find(b => b.toLowerCase() === termo.toLowerCase());
    if(exato) { buscar(exato); } 
    else { 
        const parcial = listaBairros.find(b => b.toLowerCase().includes(termo.toLowerCase()));
        buscar(parcial || termo); 
    }
});

document.getElementById('geoBtn').addEventListener('click', () => {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(pos => {
            const latlng = [pos.coords.latitude, pos.coords.longitude];
            if(mapa) {
                mapa.setView(latlng, 16);
                L.marker(latlng).addTo(mapa).bindPopup("Você está aqui!").openPopup();
                // Poderíamos adicionar lógica aqui para determinar a AISP baseada em polígonos reais
            } else {
                alert("Realize uma busca primeiro para inicializar o mapa.");
            }
        }, () => alert("Erro ao obter localização. Verifique as permissões do navegador."));
    } else {
        alert("Geolocalização não suportada neste navegador.");
    }
});

function buscar(nome) {
    if (!bairros[nome]) {
        info.innerHTML = `<h3 style="color:#c62828;">Bairro não encontrado</h3><p>Verifique a grafia. Exibindo resultados aproximados na lista acima.</p>`;
        resultado.classList.add('show');
        return;
    }
    const dados = bairros[nome].split('|');
    const aispCode = dados[0].includes('14') ? '14' : '15';
    const color = aispCode === '14' ? '#0a3d62' : '#c62828'; // Azul para Norte, Vermelho para Sul (exemplo)

    info.innerHTML = `
        <h2 style="margin-bottom:15px;color:${color}">${nome}</h2>
        <div style="display:grid;grid-template-columns:1fr;gap:15px;">
            <div style="background:#fff;padding:15px;border-radius:10px;border-left:5px solid ${color};box-shadow:0 2px 5px rgba(0,0,0,0.05)">
                <strong style="font-size:18px;display:block;margin-bottom:5px;color:#555">Área Integrada (AISP)</strong>
                <span class="badge" style="background:${color}">${dados[0]}</span>
            </div>
            <div style="background:#fff;padding:15px;border-radius:10px;border-left:5px solid ${color};box-shadow:0 2px 5px rgba(0,0,0,0.05)">
                <strong style="font-size:18px;display:block;margin-bottom:5px;color:#555">Polícia Militar</strong>
                <span style="font-size:20px;font-weight:bold">${dados[1]}</span>
            </div>
            <div style="background:#fff;padding:15px;border-radius:10px;border-left:5px solid ${color};box-shadow:0 2px 5px rgba(0,0,0,0.05)">
                <strong style="font-size:18px;display:block;margin-bottom:5px;color:#555">Polícia Civil (Delegacias)</strong>
                <span style="font-size:18px">${dados[2]}</span>
            </div>
        </div>`;
    
    iniciarMapa(nome, parseInt(aispCode));
    resultado.classList.add('show');
}

function iniciarMapa(nome, aisp) {
    if (mapa) mapa.remove();
    mapa = L.map('map').setView([-16.3285,-48.9534], 12);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
    }).addTo(mapa);

    // Polígonos Aproximados (Apenas visualização, não precisos geograficamente)
    // AISP 14 (Norte)
    const poly14 = [
        [-16.20, -49.05], [-16.20, -48.80], 
        [-16.33, -48.80], [-16.33, -49.05]
    ];
    // AISP 15 (Sul)
    const poly15 = [
        [-16.33, -49.05], [-16.33, -48.80], 
        [-16.45, -48.80], [-16.45, -49.05]
    ];

    L.polygon(poly14, {color: '#0a3d62', weight: 2, fillOpacity: 0.1}).addTo(mapa).bindPopup("Área Norte - AISP 14");
    L.polygon(poly15, {color: '#c62828', weight: 2, fillOpacity: 0.1}).addTo(mapa).bindPopup("Área Sul - AISP 15");

    const coord = coordenadas[nome] || (aisp === 14 ? [-16.305,-48.955] : [-16.365,-48.945]);
    const markerColor = aisp === 14 ? 'blue' : 'red';
    
    // Marcador Simples (Leaflet padrão é azul, mudamos a cor via CSS se necessário ou usamos ícone padrão)
    L.marker(coord).addTo(mapa)
        .bindPopup(`<b>${nome}</b><br>${bairros[nome].split('|')[0]}`)
        .openPopup();
    
    mapa.setView(coord, coordenadas[nome] ? 15 : 12);
}
</script>
</body>
</html>
